## LAB 1 QnA
This lab contains 5 steps:
1.	Create your own QnA Maker service
2. Consume your QnA Maker service
3.	Connect your QnA Maker service to the Azure Bot Service 
4.	Enable your bot on multiple channels like Skype and Telegram
5.	Embed your bot in your own website

## 1. Create your own QnA Maker service

**Microsoft QnA Maker** is a free, easy-to-use, REST API and web-based service that trains AI to respond to user's questions in a more natural, conversational way. Compatible across development platforms, hosting services, and channels, QnA Maker is the only question and answer service with a graphical user interface—meaning you don’t need to be a developer to train, manage, and use it for a wide range of solutions.
With optimized machine learning logic and the ability to integrate industry-leading language processing with ease, QnA Maker distills masses of information into distinct, helpful answers.

![QnA Maker Overview](https://github.com/Rubicon-BV/GlobalAzureBootcamp2018/blob/master/Lab1/Pics/botFrameworkArch.png)

_Our first action is to create a QnA maker service_
1. Go to the website https://qnamaker.ai/ and sign in with your Microsoft account.
2. Click on **Create new service**.  
![Create new QnA Service0](https://github.com/Rubicon-BV/GlobalAzureBootcamp2018/blob/master/Lab1/Pics/CreateQnAService0.png)
3. Enter the **Name** of your service and the web page URL that contains your **FAQ** (you can also enter the questions and answers manually or you can upload a file with your questions and answers).  
![Create new QnA Service](https://github.com/Rubicon-BV/GlobalAzureBootcamp2018/blob/master/Lab1/Pics/CreateQnAService.png)
4. For example you could use the URL of the Azure Support FAQs: https://azure.microsoft.com/en-us/support/faq/
5. The site will import the **FAQ**…  
![Create new QnA Service2](https://github.com/Rubicon-BV/GlobalAzureBootcamp2018/blob/master/Lab1/Pics/CreateQnAService2.png)
6. ...then display it in a FAQ database. You can edit the content of the database on this screen.  
![Create new QnA Service3](https://github.com/Rubicon-BV/GlobalAzureBootcamp2018/blob/master/Lab1/Pics/CreateQnAService3.png)
7. The test screen allows you to chat with the Bot who responds by retrieving the appropriate answer from the FAQ database. This screen allows you to train the Bot by indicating what answer the Bot should give to a particular question, or by supplying a new answer.  
![Create new QnA Service4](https://github.com/Rubicon-BV/GlobalAzureBootcamp2018/blob/master/Lab1/Pics/CreateQnAService4.png)
8. When you have completed training, click the **Save and retrain** button. Finally, click the **Publish** button.
![Create new QnA Service5](https://github.com/Rubicon-BV/GlobalAzureBootcamp2018/blob/master/Lab1/Pics/CreateQnAService5.png)
9. You will see a confirmation screen. Click **Publish** again.  
![Create new QnA Service6](https://github.com/Rubicon-BV/GlobalAzureBootcamp2018/blob/master/Lab1/Pics/CreateQnAService6.png)
11. You will then be presented with the information needed to consume the Bot.  
![Create new QnA Service7](https://github.com/Rubicon-BV/GlobalAzureBootcamp2018/blob/master/Lab1/Pics/CreateQnAService7.png)
12. Note, you can always get back to these values by selecting **My services**, selecting the service, then **Settings**.  
![Create new QnA Service8](https://github.com/Rubicon-BV/GlobalAzureBootcamp2018/blob/master/Lab1/Pics/CreateQnAService8.png)

## 2. Consume your QnA Maker service
Each published QnA Maker service is exposed as an HTTP endpoint that will take in a question and respond back with the best matched answer and a confidence score. You only need two GUIDs to access your knowledge base via the HTTP endpoint
* Knowledge Base ID: This is auto-generated by the system for every published QnA Maker service.  
* Subscription Key: These are assigned per account, and is used for metering.
 
### 2.1 Postman

**Postman** is a popular API client that makes it easy for developers to create, share, test and document APIs. This is done by allowing users to create and save simple and complex HTTP/s requests, as well as read their responses. 

_Our second action is to run an API request via Postman_
1. Go to [https://www.getpostman.com/apps](https://www.getpostman.com/apps)
2. Install and run Postman.
3. Now let’s send our API request!
  - Change method to **POST**
  - Combine the **Host URL** and **Post URL** from step 1.11  
  For example: https://westus.api.cognitive.microsoft.com/qnamaker/v2.0/knowledgebases/0b16d1ff-e23a-4ce1-b7ef-77bece70314c/generateAnswer
  - Add these two headers:
| Key | Value |
| --- | --- |
| Ocp-Apim-Subscription-Key | …from step 1.11 |
| Content-Type | …from step 1.11 |
  
  
![Postman1](https://github.com/Rubicon-BV/GlobalAzureBootcamp2018/blob/master/Lab1/Pics/Postman1.png)
6. Click on **+Create collection”** and enter a name. If you have a collection, choose a collection
7. Click on **Save**
8. Change the _GET_ function into **POST**
9. Copy the **Host URL** from _step 11_ in the previous chapter and paste this HOST URL after the Post Function within Postman.
10. Copy the **POST URL** from _step 11_ in the previous chapter and paste this URL after the HOST URL in the Post Function within Postman.
11. Ensure **Inherith auth from parent** is selected as **Type** under the _Authorization_ tab.
12. Click on the **Headers** tab.
13. Enter the following key/value pairs (gathered from the generated input from step 11 in the previous chapter):

| Key | Value |
| --- | --- |
| Ocp-Apim-Subscription-Key | …from step 1.11 |
| Content-Type | …from step 1.11 |

 ![Postman1](https://github.com/Rubicon-BV/GlobalAzureBootcamp2018/blob/master/Lab1/Pics/Postman1.png)

14. Click on the **Body** tab.
15. Select **Raw**
16. On the body field add **{"question":"cw5"}** or **{"question":"hi"}**
17. Click on **Send**, the following illustration is a sample result

 ![Postman2](https://github.com/Rubicon-BV/GlobalAzureBootcamp2018/blob/master/Lab1/Pics/Postman2.png)
 
18.	Click on **Save**

## 3. Connect your QnA Maker service to the Azure Bot Service 

_Our third action is to create a bot via the Azure Bot Service and configure (and test) the channels Skype and Telegram messenger._

1. Go to the [Azure Portal](https://portal.azure.com/)
2. Login with your Microsoft account, you need an **Azure subscription**
3. Click on **Create a resource**, located in the top left corner of the screen
4. Search for **BOT**
5. Select _Web App Bot_, and click on **Create**
6. Fill out the following fields
* Bot name (in this example RubiHeatBot)
* Subscription (choose your **subscription**)
* Resource group (**Create New**)
* Provide a **name** like RubiHeatBot
* Location (Select **West Europe”**)
* Pricing Tier (choose **F0 Free**)
* App name (in this example RubiHeatBot)
* Bot Template (choose **Question and Answer template**)
* App service plan **(Create New**)
* Provide a **name** like RubiHeatBot 
* Select **West Europe**
7. Azure storage (**Create New**)
* Provide a **name** like RubiHeatBot
8. Application Insights (choose **On**)
9. Location (Select **West Europe**)
10. Microsoft App ID and password (choose **Auto create App ID and Password**)
11. Click on **Create**
12. When the bot is finished click on the right side **Go to resource**
13. On the left menu of the Bot click on **Application settings**
14. Under the section **App settings**, you find:
* QnAKnowledgebaseId (put your QandAmaker settings here, in our example _67c19131-d968-4a7e-9f16-feffb982d506_)
* QnASubscriptionKey (put your QandAmaker settings here, in our example _8e132c2e5c3b43d98c66aa88ee1e9f73_)
15. In the left menu of the Bot click on **Test the Webchat**
* Type for example _hi_ or _CW 4/CW 5/CW 3_ and see if the webchat gives you an answer

## 4. Enable your bot on multiple channels like Skype and Telegram
1. In the left menu of the Bot click on **Channels**
* [Skype Channel instructions](https://docs.microsoft.com/en-us/azure/bot-service/bot-service-channel-connect-skype)
* [Telegram Channel instructions](https://docs.microsoft.com/en-us/azure/bot-service/bot-service-channel-connect-telegram)

## 5. Embed your bot in your own website
1. Open your resource group RubiHeatBot and open your App Service
2.	On the left menu in the section delevepment tools choose App Service Editor (preview)
3.	Click on Go and edit your own bot
4.	In the blue top bar click on your own bot name and choose Browse website
5. Your bot is running in your in website

